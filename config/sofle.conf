# Enable deep sleep
CONFIG_ZMK_SLEEP=y

# Increase the keyboard's wireless range
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# Enable eager debouncing
CONFIG_ZMK_KSCAN_DEBOUNCE_PRESS_MS=1
CONFIG_ZMK_KSCAN_DEBOUNCE_RELEASE_MS=7

# BLE connection stability improvements
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=6
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=12
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=400

# Clear bonds on startup (enable temporarily for troubleshooting, then disable)
# CONFIG_ZMK_BLE_CLEAR_BONDS_ON_START=y

# Force split connection before host pairing
CONFIG_ZMK_SPLIT_BLE_CENTRAL_PERIPHERALS=1
CONFIG_ZMK_BLE_INIT_PRIORITY=41

# Increase split connection stability
CONFIG_BT_MAX_CONN=6
CONFIG_ZMK_SPLIT_BLE_CENTRAL_BATTERY_LEVEL_FETCHING=y
CONFIG_ZMK_SPLIT_BLE_CENTRAL_BATTERY_LEVEL_PROXY=y

# Split connection debugging (enable temporarily)
CONFIG_ZMK_SPLIT_BLE_CENTRAL_POSITION_QUEUE_SIZE=20
CONFIG_ZMK_SPLIT_BLE_PERIPHERAL_POSITION_QUEUE_SIZE=20

# Windows/iOS compatibility settings
CONFIG_BT_GATT_ENFORCE_SUBSCRIPTION=n
CONFIG_BT_CTLR_PHY_2M=n
CONFIG_BT_GAP_AUTO_UPDATE_CONN_PARAMS=y

# HID compatibility for Windows/iOS
CONFIG_ZMK_HID_BOOT=y
CONFIG_ZMK_HID_CONSUMER_REPORT_USAGES_FULL=y

# Connection parameters optimized for Windows/iOS
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=12
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=24
CONFIG_BT_PERIPHERAL_PREF_LATENCY=0
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=400

# Disable passkey entry to simplify pairing
CONFIG_ZMK_BLE_PASSKEY_ENTRY=n
CONFIG_BT_SMP_ENFORCE_MITM=n

# Split keyboard connection settings
CONFIG_ZMK_SPLIT_BLE_CENTRAL_SPLIT_RUN_STACK_SIZE=2048
CONFIG_ZMK_SPLIT_BLE_CENTRAL_SPLIT_RUN_QUEUE_SIZE=20
CONFIG_ZMK_SPLIT_BLE_PERIPHERAL_STACK_SIZE=2048
CONFIG_ZMK_SPLIT_BLE_PERIPHERAL_PRIORITY=5

# Split connection timeout and retry settings
CONFIG_BT_MAX_CONN=5
CONFIG_BT_L2CAP_TX_MTU=65
CONFIG_BT_BUF_ACL_RX_SIZE=69
CONFIG_BT_BUF_ACL_TX_SIZE=69

# USB Logging (disable for production to save power)
# CONFIG_ZMK_USB_LOGGING=y

# Enable the Corne OLED Display
CONFIG_ZMK_DISPLAY=y

# Enable encoder
CONFIG_EC11=y
CONFIG_EC11_TRIGGER_GLOBAL_THREAD=y

# Win 11 connection stability
CONFIG_ZMK_BLE_EXPERIMENTAL_CONN=y

CONFIG_ZMK_KEYBOARD_NAME="White sofle"